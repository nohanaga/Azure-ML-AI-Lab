<div class="MCWHeader1">
Cognitive Services と機械学習
</div>

<div class="MCWHeader2">
ハンズオン ラボの事前セットアップ ガイド
</div>

<div class="MCWHeader3">
2020 年 11 月
</div>

**このドキュメントの内容**

<!-- TOC -->

- [Cognitive Services と機械学習に関するハンズオン ラボの事前セットアップ ガイド](#cognitive-services-と機械学習に関するハンズオン-ラボの事前セットアップ-ガイド)
  - [前提条件](#前提条件)
  - [ハンズオン ラボを始める前に](#ハンズオン-ラボを始める前に)

<!-- /TOC -->

# Cognitive Services と機械学習に関するハンズオン ラボの事前セットアップ ガイド<a name="cognitive-services-と機械学習に関するハンズオン-ラボの事前セットアップ-ガイド"></a>

## 前提条件<a name="前提条件"></a>

1. Microsoft Azure サブスクリプションが従量課金制または MSDN であること

 - 試用版のサブスクリプションは使用できません。Azure のリソースのクォータ制限に関連した問題が発生します。

 - 単一のリソース グループだけにしかアクセスできないサブスクリプションは使用できません。複数のリソース グループを展開できる必要があります。

## ハンズオン ラボを始める前に<a name="ハンズオン-ラボを始める前に"></a>

所要時間: 25 分

### タスク 1: Azure Machine Learning のワークスペースを作成する

1. Azure サブスクリプションの資格情報を使用して、[Azure ポータル](https://portal.azure.com)にサインインします。

2. Azure ポータルの左上隅で、**+リソースの作成**を選択します。

3. **AI + Machine Learning、 Machine Learning** を選択します。リストにない場合は、検索ボックスに **Machine Learning** と入力して検索します。

      ![「リソースの作成」ページでは、「AI + Machine Learning」と「Machine Learning」が選択されていることが表示されます。](images/01.png 'Open Create Azure Machine Learning Workspace')

4. 新しいワークスペースを構成するために、以下の情報を提供します。

   - **サブスクリプション**: 使用する Azure サブスクリプションを選択します。

   - **リソース グループ**: サブスクリプションで既存のリソース グループを使用するか、名前を入力して新しいリソース グループを作成します。リソースグループは、Azure ソリューションに関連するリソースを保持します。この例では、`amlailab` を使用しています。
  
   - **ワークスペース名**: ワークスペースを識別する一意の名前を入力します。この例では、`amlailab-csml` を使用しています。名前はリソース グループ全体で一意でなければなりません。

   - **リージョン**: ユーザーとデータ リソースに最も近い場所を選択して、ワークスペースを作成します。リージョンの違いによってコンピューティングインスタンスを利用できない場合がありますので、ここでは `米国東部(eastus)` をおすすめします。

   ![前述の値が入力された機械学習作成フォームが表示されます。確認および作成ボタンがハイライトされています。](images/02.png 'Create Azure Machine Learning Workspace page')

5. ワークスペースの設定が完了したら、**確認および作成** を選択します。先ほど入力したフィールドを確認したら、**作成** を選択します。

    > **Note**: クラウドにワークスペースを作成するには数分かかることがあります。プロセスが終了すると、デプロイの成功メッセージが表示されます。

6. 新しいワークスペースを表示するには、**リソースに移動** を選択します。

   ![概要ページには、配置が完了したことを示すメッセージが表示され、強調表示されたリソースボタンに移動します。](images/03.png 'Go to Azure Machine Learning workspace')

7. Machine Learning サービスの概要画面が表示されたら、中心付近の **スタジオの起動** ボタンをクリックします。

      ![概要ページには、配置が完了したことを示すメッセージが表示され、強調表示されたリソースボタンに移動します。](images/03_2.png 'Go to Azure Machine Learning workspace')

### タスク 2: コンピューティングインスタンスの作成

1. Azure Machine Learning ワークスペース内から、左のナビゲーションで **管理、コンピューティング** を選択し、**作成** を選択します。

   ![Azure Machine Learning ワークスペースの計算セクションでは、新しい計算インスタンスの作成ボタンが選択されていることを示しています。](images/04.png 'Create New Compute Instance')

2. 以下の情報を提供し、**作成** を選択します。

    a. コンピューティング名: `csml-compute`

    b. 仮想マシンの種類: `CPU (中央処理装置)`

    c. 仮想マシンのサイズ: `Standard_D3_V2`

   ![新しいコンピューティングインスタンスフォームが表示され、前述の値が入力されます。作成ボタンがハイライトされています。](images/05.png 'Create New Compute Instance')

   >**Note**: コンピューティングインスタンス名が Azure リージョン内で一意である必要がある場合は、環境に固有の別の名前を選択してください。
  
3. コンピューティングインスタンスの準備が整うのを待ちます。状況によっては数分かかります。

### タスク 3: ラボノートのインポート

1. 左メニューから **Notebook** を選択します。Notebooks 画面が開いたら、自分のユーザー名のディレクトリをクリックしてから、**ターミナルを開く** アイコンを選択して、ターミナルインターフェースを開きます。

   ![Azure Machine Learning ワークスペースの計算セクションは、計算インスタンス csml-compute で選択された Jupyter リンクを表示しています。](images/06.png 'Open Jupyter Notebooks')
  
2. 以下のコマンドをターミナルウィンドウで順番に実行します。

   a. `mkdir amlailab-csml`

   b. `cd amlailab-csml`

   c. `git clone https://github.com/nohanaga/Azure-ML-AI-Lab.git`

      ![前述のgithubリポジトリをクローンするためのコマンドを表示するJupyterターミナルウィンドウ](images/08.png 'Import Repository')

   d. インポートが完了するのを待ちます。`Checking out files: 100% (xxx/xxx), done.` と表示されれば完了です。

## タスク 4: Face API のデプロイ<a name="タスク-1-face-api-のデプロイ"></a>

1. ブラウザーで、Azure ポータルに移動します。

2. [**Create a resource (リソースを作成)**] を選択します。

3. [**AI + Machine Learning (AI + 機械学習)**]、[**Face**] の順に選択します。または、検索ボックスに **Face** と入力して検索します。

    ![この新規のブレードでは、[AI + Machine Learning (AI + 機械学習)] オプションが選択されています。](images/12.png 'New blade')

4. [**Create (作成)**] ブレードで、以下の値を入力します。

    - **Subscription (サブスクリプション)**: お使いの Azure のサブスクリプションを選択します。

    - **Resource group (リソース グループ)**: 既存の aml-ai-lab リソース グループを選択します。

    - **Name (名前)**: このインスタンスの一意の名前を入力します。例: `amlailab-face`

    - **Location (拠点)**: 展開している他のサービスの最も近くにある拠点を選択します。例: `米国東部(eastus)` 

    - **Pricing tier (料金レベル)**: `Standard S0` を選択します。

    - **このチェック ボックスをオンにすることによって、このサービスが米国の警察によって使用されたり、米国の警察のために使用されたりすることがないことを証明します。** にチェックします。


    ![この [Create (作成)] ブレード フィールドには、事前定義された設定が表示されています。](images/09.png 'Create blade')

5. [**確認および作成**] を選択します。

6. デプロイが正常に完了したことを知らせる通知が表示されたら、[**リソースに移動**] を選択します。

    ![デプロイが正常に完了したことを知らせる通知。](images/10.png 'Notification')

7. [**キーとエンドポイント**] を選択します。[**キー 1**] と [**エンドポイント**] の値は後で必要になるので、メモ帳などのソフトにコピーします。

    ![この [Cognitive Services] ブレードでは、[Resource Management (リソースの管理)] で [Quick start (クイック スタート)] が選択されています。](images/11.png 'Cognitive Services blade')


ハンズオンラボに参加する前に、以上の手順に従ってください。